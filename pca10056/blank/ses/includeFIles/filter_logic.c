#include "filter_logic.h"
#include <stdint.h>
#include <math.h>
#include <stdlib.h>
#include <stdio.h>
#include "arm_math.h"



const float filter_bandpass[FILTER_SIZE] = { 3.674041654448956251e-04,
                            4.867941606789827347e-04,
                            4.883760120719671249e-04,
                            3.239759535063058138e-04,
                            -1.050268638819165011e-18,
                            -4.115356423426419497e-04,
                            -7.893055444583296776e-04,
                            -1.004337565973401070e-03,
                            -9.727744036354124546e-04,
                            -6.976532167755067348e-04,
                            -2.787392004393041134e-04,
                            1.194928263430483639e-04,
                            3.341046103741973639e-04,
                            2.795549808070063591e-04,
                            -8.014951552683959132e-19,
                            -3.300032403785735369e-04,
                            -4.657294484786689281e-04,
                            -1.968315627891570330e-04,
                            5.431403405964374542e-04,
                            1.610428676940500736e-03,
                            2.665071748197078705e-03,
                            3.273228881880640984e-03,
                            3.068798920139670372e-03,
                            1.915298402309417725e-03,
                            -4.196424559463193197e-18,
                            -2.188857644796371460e-03,
                            -4.008633084595203400e-03,
                            -4.888584837317466736e-03,
                            -4.552961327135562897e-03,
                            -3.149006282910704613e-03,
                            -1.216553733684122562e-03,
                            5.054940702393651009e-04,
                            1.372936880216002464e-03,
                            1.118169166147708893e-03,
                            -2.084190327577903950e-18,
                            -1.257464406080543995e-03,
                            -1.736515783704817295e-03,
                            -7.192635093815624714e-04,
                            1.948065939359366894e-03,
                            5.677495151758193970e-03,
                            9.248127229511737823e-03,
                            1.119547151029109955e-02,
                            1.035946328192949295e-02,
                            6.389759480953216553e-03,
                            -8.312535671711775278e-18,
                            -7.160682696849107742e-03,
                            -1.301231887191534042e-02,
                            -1.576752215623855591e-02,
                            -1.461217831820249557e-02,
                            -1.007111929357051849e-02,
                            -3.883214900270104408e-03,
                            1.613028231076896191e-03,
                            4.387300927191972733e-03,
                            3.584966761991381645e-03,
                            -3.358856212777724601e-18,
                            -4.083577077835798264e-03,
                            -5.695533938705921173e-03,
                            -2.389013534411787987e-03,
                            6.572222337126731873e-03,
                            1.952162571251392365e-02,
                            3.253455832600593567e-02,
                            4.047680646181106567e-02,
                            3.869381174445152283e-02,
                            2.480932511389255524e-02,
                            -1.126676325296938554e-17,
                            -3.077180311083793640e-02,
                            -5.977388098835945129e-02,
                            -7.856467366218566895e-02,
                            -8.051999658346176147e-02,
                            -6.304316222667694092e-02,
                            -2.872150763869285583e-02,
                            1.501185167580842972e-02,
                            5.769523233175277710e-02,
                            8.864568918943405151e-02,
                            9.993615001440048218e-02,
                            8.864568918943405151e-02,
                            5.769523233175277710e-02,
                            1.501185167580842972e-02,
                            -2.872150763869285583e-02,
                            -6.304316222667694092e-02,
                            -8.051999658346176147e-02,
                            -7.856467366218566895e-02,
                            -5.977388098835945129e-02,
                            -3.077180311083793640e-02,
                            -1.126676325296938554e-17,
                            2.480932511389255524e-02,
                            3.869381174445152283e-02,
                            4.047680646181106567e-02,
                            3.253455832600593567e-02,
                            1.952162571251392365e-02,
                            6.572222337126731873e-03,
                            -2.389013534411787987e-03,
                            -5.695533938705921173e-03,
                            -4.083577077835798264e-03,
                            -3.358856212777724601e-18,
                            3.584966761991381645e-03,
                            4.387300927191972733e-03,
                            1.613028231076896191e-03,
                            -3.883214900270104408e-03,
                            -1.007111929357051849e-02,
                            -1.461217831820249557e-02,
                            -1.576752215623855591e-02,
                            -1.301231887191534042e-02,
                            -7.160682696849107742e-03,
                            -8.312535671711775278e-18,
                            6.389759480953216553e-03,
                            1.035946328192949295e-02,
                            1.119547151029109955e-02,
                            9.248127229511737823e-03,
                            5.677495151758193970e-03,
                            1.948065939359366894e-03,
                            -7.192635093815624714e-04,
                            -1.736515783704817295e-03,
                            -1.257464406080543995e-03,
                            -2.084190327577903950e-18,
                            1.118169166147708893e-03,
                            1.372936880216002464e-03,
                            5.054940702393651009e-04,
                            -1.216553733684122562e-03,
                            -3.149006282910704613e-03,
                            -4.552961327135562897e-03,
                            -4.888584837317466736e-03,
                            -4.008633084595203400e-03,
                            -2.188857644796371460e-03,
                            -4.196424559463193197e-18,
                            1.915298402309417725e-03,
                            3.068798920139670372e-03,
                            3.273228881880640984e-03,
                            2.665071748197078705e-03,
                            1.610428676940500736e-03,
                            5.431403405964374542e-04,
                            -1.968315627891570330e-04,
                            -4.657294484786689281e-04,
                            -3.300032403785735369e-04,
                            -8.014951552683959132e-19,
                            2.795549808070063591e-04,
                            3.341046103741973639e-04,
                            1.194928263430483639e-04,
                            -2.787392004393041134e-04,
                            -6.976532167755067348e-04,
                            -9.727744036354124546e-04,
                            -1.004337565973401070e-03,
                            -7.893055444583296776e-04,
                            -4.115356423426419497e-04,
                            -1.050268638819165011e-18,
                            3.239759535063058138e-04,
                            4.883760120719671249e-04,
                            4.867941606789827347e-04,
                            3.674041654448956251e-04 };

const float filter_lowpass[FILTER_SIZE] = { 2.992278677993454039e-05,
                            6.877939449623227119e-05,
                            1.168263625004328787e-04,
                            1.740310690365731716e-04,
                            2.400350349489599466e-04,
                            3.141230554319918156e-04,
                            3.952000406570732594e-04,
                            4.817766312044113874e-04,
                            5.719649489037692547e-04,
                            6.634857854805886745e-04,
                            7.536872872151434422e-04,
                            8.395769400522112846e-04,
                            9.178660111501812935e-04,
                            9.850269416347146034e-04,
                            1.037363195791840553e-03,
                            1.071090460754930973e-03,
                            1.082429196685552597e-03,
                            1.067705103196203709e-03,
                            1.023458084091544151e-03,
                            9.465549956075847149e-04,
                            8.343065273948013783e-04,
                            6.845829193480312824e-04,
                            4.959275829605758190e-04,
                            2.676650474313646555e-04,
                            -5.595048112345030656e-19,
                            -3.058952861465513706e-04,
                            -6.478077848441898823e-04,
                            -1.022428157739341259e-03,
                            -1.425314578227698803e-03,
                            -1.850878470577299595e-03,
                            -2.292394172400236130e-03,
                            -2.742032986134290695e-03,
                            -3.190923482179641724e-03,
                            -3.629237879067659378e-03,
                            -4.046304617077112198e-03,
                            -4.430743400007486343e-03,
                            -4.770628176629543304e-03,
                            -5.053667351603507996e-03,
                            -5.267406348139047623e-03,
                            -5.399440415203571320e-03,
                            -5.437647923827171326e-03,
                            -5.370422266423702240e-03,
                            -5.186914466321468353e-03,
                            -4.877270665019750595e-03,
                            -4.432865418493747711e-03,
                            -3.846524050459265709e-03,
                            -3.112728241831064224e-03,
                            -2.227801363915205002e-03,
                            -1.190071110613644123e-03,
                            1.233315746763754212e-18,
                            1.339714741334319115e-03,
                            2.824077382683753967e-03,
                            4.445768892765045166e-03,
                            6.195160094648599625e-03,
                            8.060369640588760376e-03,
                            1.002735644578933716e-02,
                            1.208006311208009720e-02,
                            1.420058496296405792e-02,
                            1.636938750743865967e-02,
                            1.856555603444576263e-02,
                            2.076706662774085999e-02,
                            2.295108884572982788e-02,
                            2.509431913495063782e-02,
                            2.717330493032932281e-02,
                            2.916480600833892822e-02,
                            3.104613348841667175e-02,
                            3.279550746083259583e-02,
                            3.439238294959068298e-02,
                            3.581779077649116516e-02,
                            3.705461695790290833e-02,
                            3.808788955211639404e-02,
                            3.890500962734222412e-02,
                            3.949596360325813293e-02,
                            3.985347598791122437e-02,
                            3.997313976287841797e-02,
                            3.985347598791122437e-02,
                            3.949596360325813293e-02,
                            3.890500962734222412e-02,
                            3.808788955211639404e-02,
                            3.705461695790290833e-02,
                            3.581779077649116516e-02,
                            3.439238294959068298e-02,
                            3.279550746083259583e-02,
                            3.104613348841667175e-02,
                            2.916480600833892822e-02,
                            2.717330493032932281e-02,
                            2.509431913495063782e-02,
                            2.295108884572982788e-02,
                            2.076706662774085999e-02,
                            1.856555603444576263e-02,
                            1.636938750743865967e-02,
                            1.420058496296405792e-02,
                            1.208006311208009720e-02,
                            1.002735644578933716e-02,
                            8.060369640588760376e-03,
                            6.195160094648599625e-03,
                            4.445768892765045166e-03,
                            2.824077382683753967e-03,
                            1.339714741334319115e-03,
                            1.233315746763754212e-18,
                            -1.190071110613644123e-03,
                            -2.227801363915205002e-03,
                            -3.112728241831064224e-03,
                            -3.846524050459265709e-03,
                            -4.432865418493747711e-03,
                            -4.877270665019750595e-03,
                            -5.186914466321468353e-03,
                            -5.370422266423702240e-03,
                            -5.437647923827171326e-03,
                            -5.399440415203571320e-03,
                            -5.267406348139047623e-03,
                            -5.053667351603507996e-03,
                            -4.770628176629543304e-03,
                            -4.430743400007486343e-03,
                            -4.046304617077112198e-03,
                            -3.629237879067659378e-03,
                            -3.190923482179641724e-03,
                            -2.742032986134290695e-03,
                            -2.292394172400236130e-03,
                            -1.850878470577299595e-03,
                            -1.425314578227698803e-03,
                            -1.022428157739341259e-03,
                            -6.478077848441898823e-04,
                            -3.058952861465513706e-04,
                            -5.595048112345030656e-19,
                            2.676650474313646555e-04,
                            4.959275829605758190e-04,
                            6.845829193480312824e-04,
                            8.343065273948013783e-04,
                            9.465549956075847149e-04,
                            1.023458084091544151e-03,
                            1.067705103196203709e-03,
                            1.082429196685552597e-03,
                            1.071090460754930973e-03,
                            1.037363195791840553e-03,
                            9.850269416347146034e-04,
                            9.178660111501812935e-04,
                            8.395769400522112846e-04,
                            7.536872872151434422e-04,
                            6.634857854805886745e-04,
                            5.719649489037692547e-04,
                            4.817766312044113874e-04,
                            3.952000406570732594e-04,
                            3.141230554319918156e-04,
                            2.400350349489599466e-04,
                            1.740310690365731716e-04,
                            1.168263625004328787e-04,
                            6.877939449623227119e-05,
                            2.992278677993454039e-05 };
//takes an input array and multyplies it with the filter coefficients
void filter_data(float32_t* input_arr, uint32_t n,float32_t* output_array, uint8_t filter_select)
{
  switch(filter_select)
  {
    case FILTER_BANDPASS :
        arm_conv_f32(input_arr,n,filter_bandpass,FILTER_SIZE,output_array);
    break;
    case FILTER_LOWPASS :
        arm_conv_f32(input_arr,n,filter_lowpass,FILTER_SIZE,output_array);
    break;
  }
}