#include "linearSVC.h"
#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include "arm_math.h"

const float32_t coefficients[53] = { 0.0011362872587533776, -6.495929400080035e-07, -0.012849948501922302, -0.14282646611521263, -0.002148908852764723,
                          -0.008889081626416844, -0.005179458277198981, -0.025450521101282347, -0.0009852012170235296, -0.060099148423857274,
                          -0.05467207495562918, 0.015820641623535178, 0.011989007203986568, 0.010757444506857004, -0.004659237398652746,
                          -0.006953703625524951, -0.02279750552221973, -0.0007065707511616314, -0.046496988977605264, 0.003095546212293421, 
                          -0.004524605996619245, 0.010496176170523088, 0.009405247576739925, -0.0012860162114952493, 2.6691053229129664e-06, 
                           1.8594632518885896e-06, -0.0007838603999351151, -0.04082207635498747, -0.08326372441271644, -0.11962074882042517, 
                          -0.0028225074658236593, -0.0008339029270486658, -0.0009305783715850406, -0.0010069425451173764, -0.0004606845533172332, 
                          -0.0015965879390731133, 0.002713986047853587, 1.2591068064632487e-06, -0.12205480875286731, -0.0009719146419720356, 
                          -0.0010681787205993035, 7.013727357140517e-06, -0.13967689159463853, -0.13843175418273973, -0.06936904641337978, 
                          -0.04850756560377649, -0.004421100577800353, -0.0013566559054517433, -0.0025947536789878585, -0.0024388668244957295, 
                          -0.0009210247514879623, -0.002992491388760454, -0.08339365883075837};

float32_t intercepts = -0.41071015139598754;
/*
input:feature array you calculated from acc data, lenght of the array
output: "eating = 1" "not eating = 0"
*/
uint8_t predict (float32_t* features, uint32_t l) {
    int i;
    float32_t prob = 0.0;

    for (i = 0; i < l; i++) {
        prob += coefficients[i] * features[i];
    }
    if (prob + intercepts > 0) {
        return 1;
    }
    return 0;
}